# SCTagommender

Neo4j-based tagommender for SoundCloud data

## Introduction

Originally [based on this blog post](http://neo4j.com/blog/soundcloud-recommendations-neo4j/).

## Setting up Neo4j

If you're not running Neo4j on a server, you can set it up locally by [downloading Neo4j](http://neo4j.com/download/) and following the setup instructions.

## Skip the APIs and play with some sample data

* Get your [SoundCloud id](https://developers.soundcloud.com/docs/api/guide) and update `/settings`
* `pip install -r requirements.txt`
* Have a Neo4j database running
* `python legacy_import.py`

## The Model

### Nodes

Track

* `id`: SoundCloud id of the track 
* `title`: The title of the track
* `playback_count`: Number of times the track has been played
* `permalink_url`: URL of the track

Example Track:

```
id: 241386808
title: "Rains of Castamere" | Game of Thrones Sleep Podcast Game of Drones | Sleep With Me #219
playback_count: 86
permalink_url: https://soundcloud.com/sleepwithmepodcast/rains-of-castamere-game-of
```

Tag

* `name`: the name of the tag (for example, “story”)

Concept

* `name`: Concept represented by the concept
* `sense`: In what sense is the concept being used?
* `language`: The language of the concept
* `partOfSpeech`: The part of speech of the concept

Example Concept

```
name: story
sense: a_piece_of_fiction_that_narrates_a_chain_of_related_events
language: en
partOfSpeech: n
```

### Relationships

`(Track)-[:HAS_TAG]->(Tag)`

SoundCloud tracks have tags generated by their creators.
This is an N:N relationship.

`(Tag)-[:HAS_CONCEPT]->(Concept)`

A `Tag` is matched to a `Concept` if the `Tag`'s `name` matches the `Concept`'s `name`. 
As many `Concepts` with the same `concepts` can have different `sense`s (there are multiple senses of “toast”, for example), this is a 1:N relationship. 

`(Concept)-[:ASSERTION]-(Concept)`

Assertions are how ConceptNet concepts are related to one another, and have the properties:

* `type`: `IsA`, `IsNotA`, `DerivedFrom`, and many more
* `weight`: the strength of the assertion, calculated by ConceptNet
* `surfaceText`: A sentence explaining the assertion

### Import sample data

### Query the database

Since the world of SoundCloud tag recommendations is surprisingly NSFW, let’s find some tag recommendations for tracks tagged with "ambient" (a safe serach term). 

```
MATCH (track:Track)-[a:HAS_TAG]->(tag:Tag)-[:HAS_CONCEPT]->(concept:Concept)
MATCH (track)-[:HAS_TAG]->(:Tag {name:"ambient"})
OPTIONAL MATCH (concept)-[assert:ASSERTION]->(suggestedTag:Concept)
RETURN track.title, collect(DISTINCT tag.name) AS Tags, collect(DISTINCT suggestedTag.name) AS Suggestions
ORDER BY track.title ASC
```

Look for antonyms in the ConceptNet data

```
MATCH (n:Concept {language:'en'})-[r:ASSERTION {type:'Antonym'}]-(m:Concept {language:'en'})
RETURN n.name AS `Concept`, n.sense AS `in the sense of`, m.name AS `Has Antonym`
ORDER BY r.weight DESC, n.sense ASC
LIMIT 10
```

## Sample Queries

## Resources

[Folksonomy-based Tag Recommendation for Online Audio Clip Sharing](http://ismir2012.ismir.net/event/papers/073_ISMIR_2012.pdf)